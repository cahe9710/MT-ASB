function [F,M] = calc_hullAero(aws,awa)

global settings data
run(settings.ShipData)
awad = rad2deg(awa);
%if isnan(awa);STOPPPP;end
%if (r2d(abs(awa))>180); STOPPPP;end

Lref_air_hull = L; % Reference length for Hull_Aero â‰ˆLOA
Sref_air_hull = Area_hullAero; % Reference Area for Hull_Aero

% To extract from STARCKS data, use
% A=[awa, CT,CC,Cl,CN];A=A(1:10:end,:),plot((A(:,1)),A(:,2:end),'+-')

% Data from hull data_D3B.txt
% A contains A=[awa CT,CC, Cl, Cn]
A=[ - 0.01    0.2037   -0.0105    0.0010    0.0028
    1.0481    0.2049    0.0436   -0.0028   -0.0156
    2.0617    0.2107    0.1021   -0.0071   -0.0339
    3.0459    0.2158    0.1526   -0.0108   -0.0532
    4.0427    0.2220    0.2015   -0.0145   -0.0733
    5.0473    0.2231    0.2467   -0.0180   -0.0937
    6.0480    0.2322    0.3017   -0.0221   -0.1134
    7.0495    0.2412    0.3561   -0.0262   -0.1313
    8.0366    0.2487    0.4120   -0.0305   -0.1509
    9.0612    0.2533    0.4679   -0.0345   -0.1702
   10.0546    0.2542    0.5213   -0.0386   -0.1875
   11.0498    0.2556    0.5824   -0.0432   -0.2036
   12.0497    0.2549    0.6509   -0.0484   -0.2222
   13.0451    0.2543    0.7117   -0.0530   -0.2371
   14.0559    0.2521    0.7670   -0.0571   -0.2507
   15.0482    0.2527    0.8490   -0.0630   -0.2685
   16.0546    0.2525    0.9324   -0.0690   -0.2847
   17.0430    0.2541    1.0030   -0.0741   -0.2973
   18.0316    0.2509    1.0782   -0.0794   -0.3099
   19.0417    0.2506    1.1607   -0.0852   -0.3256
   20.0514    0.2472    1.2425   -0.0910   -0.3402
   21.0454    0.2481    1.3209   -0.0965   -0.3564
   22.0457    0.2493    1.4107   -0.1031   -0.3745
   23.0596    0.2448    1.4823   -0.1080   -0.3880
   24.0400    0.2503    1.5438   -0.1127   -0.3968
   25.0574    0.2549    1.6299   -0.1193   -0.4098
   26.0474    0.3019    1.7213   -0.1290   -0.4180
   27.0474    0.3058    1.7981   -0.1349   -0.4323
   28.0421    0.3121    1.8973   -0.1422   -0.4490
   29.0421    0.3155    1.9821   -0.1485   -0.4665
   30.0569    0.3120    2.0803   -0.1554   -0.4847
   31.0473    0.3092    2.1482   -0.1605   -0.4975
   32.0640    0.3232    2.2415   -0.1670   -0.5161
   33.0501    0.3133    2.3025   -0.1716   -0.5250
   34.0396    0.3189    2.4112   -0.1791   -0.5502
   35.0684    0.3088    2.4824   -0.1841   -0.5658
   36.0384    0.3107    2.5753   -0.1905   -0.5911
   37.0421    0.3037    2.6404   -0.1953   -0.6033
   38.0593    0.3060    2.7081   -0.2001   -0.6155
   39.0599    0.3050    2.7849   -0.2059   -0.6266
   40.0516    0.3027    2.8542   -0.2103   -0.6387
   41.0519    0.3029    2.9091   -0.2144   -0.6493
   42.0511    0.3020    2.9411   -0.2167   -0.6522
   43.0491    0.2976    2.9969   -0.2206   -0.6635
   44.0538    0.2952    3.0390   -0.2242   -0.6820
   45.0672    0.3008    3.0669   -0.2263   -0.6783
   46.0516    0.2951    3.1095   -0.2294   -0.6773
   47.0601    0.2946    3.1616   -0.2329   -0.6754
   48.0470    0.2808    3.2262   -0.2361   -0.6635
   49.0442    0.2689    3.2350   -0.2371   -0.6509
   50.0485    0.2757    3.2961   -0.2409   -0.6352
   51.0558    0.2660    3.2830   -0.2397   -0.6117
   52.0519    0.2495    3.3257   -0.2425   -0.6127
   53.0574    0.2333    3.3474   -0.2440   -0.5963
   54.0535    0.2369    3.3448   -0.2444   -0.5916
   55.0521    0.2185    3.2975   -0.2404   -0.5591
   56.0514    0.2123    3.2917   -0.2404   -0.5551
   57.0476    0.1998    3.2997   -0.2411   -0.5463
   58.0595    0.1833    3.3093   -0.2416   -0.5430
   59.0481    0.1765    3.2884   -0.2402   -0.5201
   60.0566    0.1819    3.2744   -0.2391   -0.4811
   61.0380    0.1775    3.2105   -0.2354   -0.4718
   62.0441    0.1666    3.1860   -0.2335   -0.4427
   63.0452    0.1705    3.1506   -0.2315   -0.4140
   64.0538    0.1862    3.1300   -0.2281   -0.3674
   65.0401    0.1955    3.1494   -0.2281   -0.3382
   66.0404    0.1876    3.1149   -0.2263   -0.3190
   67.0474    0.1975    3.0907   -0.2250   -0.3062
   68.0374    0.1964    3.1143   -0.2262   -0.2875
   69.0482    0.2109    3.0380   -0.2219   -0.2620
   70.0483    0.2193    3.0145   -0.2215   -0.2494
   71.0544    0.2203    3.0106   -0.2215   -0.2277
   72.0410    0.2255    3.0129   -0.2213   -0.2104
   73.0407    0.2432    2.9840   -0.2198   -0.1905
   74.0560    0.2350    2.9716   -0.2192   -0.1797
   75.0486    0.2518    2.9377   -0.2172   -0.1611
   76.0529    0.2480    2.9403   -0.2176   -0.1560
   77.0512    0.2570    2.9089   -0.2161   -0.1400
   78.0503    0.2955    2.8513   -0.2135   -0.1240
   79.0512    0.2644    2.8736   -0.2138   -0.1117
   80.0402    0.2890    2.8432   -0.2131   -0.1017
   81.0437    0.3636    2.7693   -0.2100   -0.0838
   82.0425    0.3502    2.7592   -0.2090   -0.0621
   83.0476    0.4008    2.6871   -0.2062   -0.0462
   84.0662    0.3933    2.6898   -0.2064   -0.0373
   85.0484    0.4041    2.7030   -0.2072   -0.0159
   86.0496    0.4354    2.6328   -0.2041    0.0058
   87.0712    0.4652    2.6486   -0.2044    0.0330
   88.0521    0.4659    2.6106   -0.2024    0.0450
   89.0392    0.5255    2.5914   -0.2012    0.0711
   90.0523    0.6184    2.5421   -0.1981    0.1054
   91.0441    0.6513    2.5633   -0.1975    0.1322
   92.0504    0.6776    2.5206   -0.1948    0.1609
   93.0533    0.6826    2.5471   -0.1961    0.1779
   94.0576    0.6525    2.5405   -0.1959    0.2014
   95.0535    0.6443    2.5424   -0.1955    0.2161
   96.0565    0.6148    2.5453   -0.1951    0.2315
   97.0503    0.5927    2.5368   -0.1946    0.2415
   98.0592    0.5577    2.5539   -0.1942    0.2604
   99.0529    0.5331    2.5309   -0.1929    0.2683
  100.0422    0.5033    2.5285   -0.1927    0.2815
  101.0502    0.4787    2.5458   -0.1924    0.3048
  102.0608    0.4421    2.5210   -0.1913    0.3103
  103.0459    0.4219    2.5301   -0.1908    0.3268
  104.0462    0.3897    2.5160   -0.1899    0.3377
  105.0515    0.3564    2.4836   -0.1873    0.3438
  106.0433    0.3315    2.5196   -0.1879    0.3738
  107.0583    0.2989    2.4839   -0.1860    0.3735
  108.0504    0.2700    2.4764   -0.1850    0.3891
  109.0482    0.2336    2.4862   -0.1846    0.4028
  110.0516    0.2140    2.4908   -0.1841    0.4179
  111.0506    0.1840    2.4929   -0.1838    0.4344
  112.0362    0.1603    2.5002   -0.1838    0.4476
  113.0342    0.1396    2.4996   -0.1835    0.4581
  114.0499    0.1171    2.5023   -0.1832    0.4834
  115.0435    0.1137    2.5268   -0.1838    0.5150
  116.0444    0.0962    2.5173   -0.1827    0.5312
  117.0424    0.0744    2.5202   -0.1822    0.5505
  118.0521    0.0589    2.5128   -0.1808    0.5746
  119.0488    0.0387    2.5165   -0.1799    0.5915
  120.0540    0.0170    2.5541   -0.1812    0.6064
  121.0492    0.0437    2.6070   -0.1836    0.6496
  122.0494    0.0432    2.6602   -0.1857    0.6708
  123.0396    0.0293    2.6915   -0.1869    0.6837
  124.0463    0.0112    2.7026   -0.1868    0.7044
  125.0619   -0.0166    2.7487   -0.1887    0.7078
  126.0457   -0.0238    2.7299   -0.1872    0.7198
  127.0574   -0.0493    2.7510   -0.1874    0.7245
  128.0403   -0.0647    2.7589   -0.1872    0.7266
  129.0453   -0.0916    2.7421   -0.1853    0.7296
  130.0497   -0.1069    2.7770   -0.1867    0.7353
  131.0345   -0.1417    2.7377   -0.1834    0.7305
  132.0609   -0.1636    2.7388   -0.1831    0.7340
  133.0481   -0.1884    2.7222   -0.1814    0.7338
  134.0527   -0.2173    2.7215   -0.1806    0.7380
  135.0578   -0.2359    2.6997   -0.1786    0.7364
  136.0507   -0.2702    2.6784   -0.1765    0.7377
  137.0418   -0.2934    2.6502   -0.1739    0.7322
  138.0407   -0.3127    2.6315   -0.1717    0.7310
  139.0410   -0.3332    2.6003   -0.1689    0.7262
  140.0438   -0.3501    2.5507   -0.1650    0.7277
  141.0533   -0.3653    2.5109   -0.1618    0.7191
  142.0678   -0.3789    2.4644   -0.1586    0.7071
  143.0624   -0.3943    2.4021   -0.1541    0.7001
  144.0465   -0.4071    2.3161   -0.1473    0.6804
  145.0469   -0.4228    2.2536   -0.1428    0.6591
  146.0297   -0.4310    2.1966   -0.1384    0.6475
  147.0444   -0.4465    2.1329   -0.1342    0.6324
  148.0642   -0.4674    2.0688   -0.1300    0.6034
  149.0568   -0.4817    2.0041   -0.1255    0.5843
  150.0519   -0.4947    1.9285   -0.1205    0.5636
  151.0533   -0.5042    1.8524   -0.1155    0.5501
  152.0510   -0.5204    1.8006   -0.1122    0.5254
  153.0388   -0.5321    1.7503   -0.1091    0.5010
  154.0389   -0.5464    1.6787   -0.1045    0.4771
  155.0560   -0.5579    1.6057   -0.0998    0.4581
  156.0585   -0.5648    1.5277   -0.0947    0.4417
  157.0516   -0.5727    1.4582   -0.0901    0.4204
  158.0422   -0.5742    1.3794   -0.0851    0.4013
  159.0560   -0.5810    1.3035   -0.0803    0.3790
  160.0333   -0.5871    1.2315   -0.0758    0.3595
  161.0496   -0.5894    1.1483   -0.0706    0.3387
  162.0315   -0.5897    1.0697   -0.0657    0.3196
  163.0472   -0.5921    0.9943   -0.0610    0.3005
  164.0493   -0.5941    0.9048   -0.0554    0.2813
  165.0494   -0.5911    0.8317   -0.0509    0.2667
  166.0367   -0.5874    0.7516   -0.0460    0.2485
  167.0464   -0.5871    0.6599   -0.0402    0.2259
  168.0485   -0.5859    0.5919   -0.0359    0.2120
  169.0381   -0.5780    0.5126   -0.0303    0.2038
  170.0465   -0.5708    0.4271   -0.0245    0.1898
  171.0431   -0.5649    0.3580   -0.0198    0.1776
  172.0561   -0.5610    0.2912   -0.0155    0.1661
  173.0406   -0.5539    0.2272   -0.0112    0.1489
  174.0479   -0.5474    0.1707   -0.0078    0.1346
  175.0441   -0.5405    0.1293   -0.0053    0.1177
  176.0609   -0.5379    0.0954   -0.0036    0.0992
  177.0445   -0.5367    0.0744   -0.0028    0.0762
  178.0502   -0.5303    0.0597   -0.0023    0.0519
  179.0527   -0.5300    0.0341   -0.0012    0.0276
  180.0393   -0.5315    0.0135   -0.0003    0.0046
  181.0331   -0.5268   -0.0205    0.0015   -0.0167
  182.0519   -0.5268   -0.0379    0.0025   -0.0457
  183.0484   -0.5256   -0.0513    0.0026   -0.0711
  184.0518   -0.5271   -0.0844    0.0044   -0.0915
  185.0478   -0.5270   -0.1208    0.0064   -0.1069
  186.0483   -0.5316   -0.1775    0.0100   -0.1207
  187.0498   -0.5301   -0.2224    0.0127   -0.1350
  188.0394   -0.5392   -0.2812    0.0167   -0.1533
  189.0508   -0.5431   -0.3511    0.0215   -0.1684
  190.0488   -0.5450   -0.4272    0.0265   -0.1771
  190.1106   -0.5473   -0.4234    0.0264   -0.1772
  190.0745   -0.5474   -0.4278    0.0266   -0.1779
  190.0492   -0.5435   -0.4239    0.0263   -0.1774];

CT = -interp1(A(:,1),A(:,2),abs(awad)); % Surge

CC = -interp1(A(:,1),A(:,3),abs(awad)); % Sway
Cl = interp1(A(:,1),A(:,4),abs(awad))*sign(awa); % Roll
Cn = interp1(A(:,1),A(:,5),abs(awad))*sign(awa); % Yaw

q  = 0.5*settings.rho_air*aws^2; % Dynamic pressure 


Fx = q*CT*Sref_air_hull;
Fy = q*CC*sign(awa)*Sref_air_hull;
Fz = 0;

Mx = q*Cl*Sref_air_hull*Lref_air_hull; % [Nm] reference at waterplane Se STARCK sec 2.2
My = 0;
Mz = q*Cn*Sref_air_hull*Lref_air_hull; % Around mid-ship

data.xCP_hullAero = Mz/Fy; %
if isnan(data.xCP_hullAero);data.xCP_hullAero=0;end


F = [Fx;Fy;Fz];
M = [Mx;My;Mz];
